USE FAERS_B
GO


--UPDATE DRUG_Mapper WITH CLEANED DRUGNAMES AND PROD_AI
UPDATE  DRUG_Mapper 
SET CLEANED_DRUGNAME = DRUG_Mapper_Temp.CLEANED_DRUGNAME

FROM DRUG_Mapper_Temp INNER JOIN DRUG_Mapper ON 
DRUG_Mapper_Temp.DRUGNAME = DRUG_Mapper.DRUGNAME
WHERE DRUG_Mapper.NOTES IS NULL
----------------------------------
UPDATE  DRUG_Mapper 
SET CLEANED_PROD_AI = DRUG_Mapper_Temp.CLEANED_PROD_AI

FROM DRUG_Mapper_Temp INNER JOIN DRUG_Mapper ON 
DRUG_Mapper_Temp.PROD_AI = DRUG_Mapper.PROD_AI 
WHERE DRUG_Mapper.NOTES IS NULL
----------------------------------

--MATCH WITH INSIDE ()
UPDATE  DRUG_Mapper 
SET RXAUI = [RXNCONSO].RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.1
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM [RXNCONSO] INNER JOIN DRUG_Mapper ON 

	RXNCONSO.STR = CLEANED_DRUGNAME

		 WHERE  NOTES IS NULL
		 AND [RXNCONSO].SAB = 'RXNORM'
		AND [RXNCONSO].TTY IN ('MIN', 'IN', 'PIN')
------------------------------------------------------------------
		--MATCH WITH INSIDE ()	
UPDATE  DRUG_Mapper 
SET RXAUI = [RXNCONSO].RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.2
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM [RXNCONSO] INNER JOIN DRUG_Mapper ON 

	RXNCONSO.STR = CLEANED_PROD_AI
		 WHERE  NOTES IS NULL
		 AND [RXNCONSO].SAB = 'RXNORM'
		AND [RXNCONSO].TTY IN ('MIN', 'IN', 'PIN')
--------------------------------------
--MATCH WITH INSIDE ()
UPDATE  DRUG_Mapper 
SET RXAUI = RXNCONSO.RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.3
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM IDD INNER JOIN DRUG_Mapper ON 

	IDD.DRUGNAME = CLEANED_DRUGNAME
	INNER JOIN RXNCONSO ON RXNCONSO.RXAUI = IDD.RXAUI
		 WHERE  NOTES IS NULL
		 AND [RXNCONSO].SAB = 'RXNORM'
		AND [RXNCONSO].TTY IN ('MIN', 'IN', 'PIN')
-----------------------------------------------------------
		
--MATCH WITH INSIDE ()
UPDATE  DRUG_Mapper 
SET RXAUI = RXNCONSO.RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.4
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM IDD INNER JOIN DRUG_Mapper ON 
	IDD.DRUGNAME = CLEANED_PROD_AI
	INNER JOIN RXNCONSO ON RXNCONSO.RXAUI = IDD.RXAUI
		 WHERE  NOTES IS NULL
		 AND [RXNCONSO].SAB = 'RXNORM'
		AND [RXNCONSO].TTY IN ('MIN', 'IN', 'PIN')
-------------------------------------------------------

UPDATE  DRUG_Mapper 
SET RXAUI = [RXNCONSO].RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.5
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM [RXNCONSO] INNER JOIN DRUG_Mapper ON 

	RXNCONSO.STR = CLEANED_DRUGNAME

		 WHERE  NOTES IS NULL
		
		AND [RXNCONSO].TTY ='IN'
-------------------------------------------------------------	
		--MATCH WITH INSIDE ()	
UPDATE  DRUG_Mapper 
SET RXAUI = [RXNCONSO].RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.6
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM [RXNCONSO] INNER JOIN DRUG_Mapper ON 

	RXNCONSO.STR = CLEANED_PROD_AI
		 WHERE  NOTES IS NULL
		
		AND [RXNCONSO].TTY = 'IN'
------------------------------------------------------------------

--MATCH WITH INSIDE ()
UPDATE  DRUG_Mapper 
SET RXAUI = RXNCONSO.RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.7
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM IDD INNER JOIN DRUG_Mapper ON 
	IDD.DRUGNAME = CLEANED_DRUGNAME
	INNER JOIN RXNCONSO ON RXNCONSO.RXAUI = IDD.RXAUI
		 WHERE  NOTES IS NULL
		 
		AND [RXNCONSO].TTY = 'IN'
--------------------------------------------------------------------
		
--MATCH WITH INSIDE ()
UPDATE  DRUG_Mapper 
SET RXAUI = RXNCONSO.RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.8
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM IDD INNER JOIN DRUG_Mapper ON 
	IDD.DRUGNAME = CLEANED_PROD_AI
	INNER JOIN RXNCONSO ON RXNCONSO.RXAUI = IDD.RXAUI
		 WHERE  NOTES IS NULL
		
		AND [RXNCONSO].TTY = 'IN'
---------------------------------------------------
UPDATE  DRUG_Mapper 
SET RXAUI = [RXNCONSO].RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.9
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM [RXNCONSO] INNER JOIN DRUG_Mapper ON 

	RXNCONSO.STR = CLEANED_DRUGNAME

		 WHERE  NOTES IS NULL
		
--------------------------------------------------
		
		--MATCH WITH INSIDE ()	
UPDATE  DRUG_Mapper 
SET RXAUI = [RXNCONSO].RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.10
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM [RXNCONSO] INNER JOIN DRUG_Mapper ON 
	RXNCONSO.STR = CLEANED_PROD_AI
		 WHERE  NOTES IS NULL
	
------------------------------------------------------------------
--MATCH WITH INSIDE ()
UPDATE  DRUG_Mapper 
SET RXAUI = RXNCONSO.RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.11
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM IDD INNER JOIN DRUG_Mapper ON 
	IDD.DRUGNAME = CLEANED_DRUGNAME
	INNER JOIN RXNCONSO ON RXNCONSO.RXAUI = IDD.RXAUI
		 WHERE  NOTES IS NULL
		 
------------------------------------------------
		
--MATCH WITH INSIDE ()
UPDATE  DRUG_Mapper 
SET RXAUI = RXNCONSO.RXAUI, RXCUI = [RXNCONSO].RXCUI,  NOTES = 9.12
, SAB = [RXNCONSO].SAB, TTY = [RXNCONSO].TTY, STR=[RXNCONSO].STR, CODE  =[RXNCONSO].CODE

FROM IDD INNER JOIN DRUG_Mapper ON 
	IDD.DRUGNAME = CLEANED_PROD_AI
	INNER JOIN RXNCONSO ON RXNCONSO.RXAUI = IDD.RXAUI
		 WHERE  NOTES IS NULL
	
	
